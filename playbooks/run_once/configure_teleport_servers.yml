- hosts: 
    - teleport_auth_servers
  gather_facts: true
  become: True
  any_errors_fatal: true
  tasks:
    - import_role:
        name: install_required_packages
        tasks_from: install_baseline_packages_vm
    - include_role: # loop through to pull in multiple tasks (only works with include)
        name: networking
        tasks_from: '{{ item }}'
      loop:
        - install_frr
        - configure_frr_teleport
    - import_role:
        name: gravitational_teleport
        tasks_from: configure_server

  tags: ['configure_teleport_auth_server']

- hosts: 
    - teleport_proxy_servers
  gather_facts: true
  become: True
  any_errors_fatal: true
  tasks:
    - import_role:
        name: gravitational_teleport
        tasks_from: configure_proxy

  tags: ['configure_teleport_proxy_server']